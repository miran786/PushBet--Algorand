---
phase: 4
plan: 4.2
wave: 2
---

# Plan 4.2: Verify Full Application Flow

## Objective
Verify the end-to-end functionality of the core features: Fitness Arena, Commute Pool, Asset Lending, and Marketplace.
This involves deploying fresh contracts to Testnet, updating the frontend configuration, and performing manual verification.

## Context
- **Contracts**: `trust_score.teal`, `commute_checkin.teal`, `marketplace_contract.teal`, `asset_escrow.teal`.
- **Frontend**: Pages in `src/app/pages/` have hardcoded App IDs that need updating.
- **Scripts**: `deploy_all.cjs` deploys Trust, Commute, Marketplace. `deploy_asset_lending.cjs` deploys Asset Lending.

## Tasks

<task type="auto">
  <name>Deploy All Contracts</name>
  <files>scripts/deploy_all.cjs, scripts/deploy_asset_lending.cjs</files>
  <action>
    1. Run `node scripts/deploy_all.cjs` to deploy Trust Score, Commute, and Marketplace contracts. (Done)
    2. Run `node scripts/deploy_asset_lending.cjs` to deploy Asset Lending contract. (Done - ID: 755413192)
    3. Capture the **App IDs** from the output. (Done)
  </action>
  <verify>Check console output for "âœ… Deployed! App ID: ..." messages.</verify>
  <done>All 4 contracts deployed and App IDs updated in frontend.</done>
</task>

<task type="manual">
  <name>Update Frontend Config</name>
  <files>src/app/pages/CommuteArena.tsx, src/app/pages/Marketplace.tsx, src/app/pages/AssetArena.tsx, src/app/pages/Reputation.tsx</files>
  <action>
    Replace the hardcoded App IDs in the frontend files with the newly deployed IDs.
    - **Trust Score App ID**: Update in `Reputation.tsx` (and others if used).
    - **Commute App ID**: Update in `CommuteArena.tsx`.
    - **Marketplace App ID**: Update in `Marketplace.tsx`.
    - **Lending App ID**: Update in `AssetArena.tsx`.
  </action>
  <verify>Grep for the old IDs to ensure they are replaced.</verify>
  <done>Frontend files updated with new IDs.</done>
</task>

<task type="checkpoint:human-verify">
  <name>Verify Fitness & Commute (Browser)</name>
  <files>src/app/pages/Arena.tsx, src/app/pages/CommuteArena.tsx</files>
  <action>
    1. **Fitness**: Open "Fitness Arena". Allow Camera. Do 1 pushup. Verify count increments.
    2. **Commute**: Open "Commute Arena". Click "I Need a Ride" -> "Start Trip". Verifies Geolocation.
  </action>
  <verify>Manual confirmation.</verify>
  <done>Fitness and Commute features working.</done>
</task>

<task type="checkpoint:human-verify">
  <name>Verify Marketplace & Lending (Browser)</name>
  <files>src/app/pages/Marketplace.tsx, src/app/pages/AssetArena.tsx</files>
  <action>
    1. **Marketplace**: List a dummy item. Switch wallet/account. Buy the item. Verify atomic transfer.
    2. **Lending**: Open "Asset Arena". Register an item ("Laptop"). Switch account. Borrow the item.
  </action>
  <verify>Manual confirmation.</verify>
  <done>Marketplace and Lending features working.</done>
</task>
